{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-09-11T19:12:04.904555Z", "invocation_id": "4b97f085-6b3c-4449-bf8c-f31f2ffa49e2", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:11:57.324587Z", "completed_at": "2024-09-11T19:11:57.350553Z"}, {"name": "execute", "started_at": "2024-09-11T19:11:57.365789Z", "completed_at": "2024-09-11T19:11:58.364779Z"}], "thread_id": "Thread-2", "execution_time": 1.051398754119873, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "b1c3cb29-1349-4bda-aa17-6f8087883191", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.my_dbt_project.stg_merchants", "compiled": true, "compiled_code": "\n\nSELECT \n    merchant_id,\n    merchant_name\nFROM `burnished-flare-384310`.`seQura_dbt`.`merchants`", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`stg_merchants`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:11:57.327465Z", "completed_at": "2024-09-11T19:11:57.337213Z"}, {"name": "execute", "started_at": "2024-09-11T19:11:57.337919Z", "completed_at": "2024-09-11T19:11:58.366753Z"}], "thread_id": "Thread-3", "execution_time": 1.0528881549835205, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "798d7334-a2b6-4153-bea2-951f7b554124", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.my_dbt_project.stg_orders", "compiled": true, "compiled_code": "\n\nWITH raw_orders AS (\n    SELECT \n        order_id,\n        shopper_id,\n        order_date,\n        product_id,\n        merchant_id,\n        is_in_default,\n        days_unbalanced,\n        current_order_value,\n        overdue_principal,\n        overdue_fees\n    FROM `burnished-flare-384310`.`seQura_dbt`.`orders`\n)\n\nSELECT \n    *,\n    overdue_principal + overdue_fees AS total_overdue \nFROM raw_orders\nWHERE current_order_value IS NOT NULL", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`stg_orders`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:11:57.333591Z", "completed_at": "2024-09-11T19:11:57.357526Z"}, {"name": "execute", "started_at": "2024-09-11T19:11:57.368081Z", "completed_at": "2024-09-11T19:11:58.517715Z"}], "thread_id": "Thread-4", "execution_time": 1.2031760215759277, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "bc1f3580-08e4-4484-8660-8b6f7fc29de9", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.my_dbt_project.stg_product", "compiled": true, "compiled_code": "\n\nSELECT \n    product_id,\n    product_name\nFROM `burnished-flare-384310`.`seQura_dbt`.`products`", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`stg_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:11:57.316171Z", "completed_at": "2024-09-11T19:11:57.337637Z"}, {"name": "execute", "started_at": "2024-09-11T19:11:57.363249Z", "completed_at": "2024-09-11T19:11:58.521665Z"}], "thread_id": "Thread-1", "execution_time": 1.209123134613037, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "1cbf0206-12db-4029-a594-9621dd053506", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.my_dbt_project.stg_dim_shoppers", "compiled": true, "compiled_code": "\n\nSELECT \n    shopper_id,\n    age\nFROM `burnished-flare-384310`.`seQura_dbt`.`dim_shoppers`", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`stg_dim_shoppers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:11:58.372401Z", "completed_at": "2024-09-11T19:11:58.376213Z"}, {"name": "execute", "started_at": "2024-09-11T19:11:58.376604Z", "completed_at": "2024-09-11T19:11:59.373441Z"}], "thread_id": "Thread-2", "execution_time": 1.002147912979126, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "22d4b810-4c5b-41bb-90fc-d005d9b91aa2", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.my_dbt_project.stg_rel_default_order_type", "compiled": true, "compiled_code": "\n\nSELECT \n    default_type_id,\n    order_id,\n    default_type\nFROM `burnished-flare-384310`.`seQura_dbt`.`rel_default_order_type`", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`stg_rel_default_order_type`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:11:59.382440Z", "completed_at": "2024-09-11T19:11:59.390834Z"}, {"name": "execute", "started_at": "2024-09-11T19:11:59.391815Z", "completed_at": "2024-09-11T19:12:00.620148Z"}], "thread_id": "Thread-3", "execution_time": 1.239595890045166, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "ad3849ed-4ba2-4997-b804-f14b4901b70a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.my_dbt_project.intermediate_loans_mora_analysis", "compiled": true, "compiled_code": "\n\nWITH arrears_data AS (\n    -- Extraemos los datos necesarios de la tabla de orders\n    SELECT\n        o.order_id,\n        o.shopper_id,\n        s.age AS shopper_age, \n        o.merchant_id,\n        m.merchant_name AS merchant,\n        p.product_name AS product,\n        r.default_type,\n        o.order_date,\n        FORMAT_DATE('%Y-%m', o.order_date) AS month_year_order,\n        o.current_order_value,\n        o.total_overdue,\n        o.days_unbalanced\n    FROM `burnished-flare-384310`.`seQura_dbt`.`stg_orders` o\n    LEFT JOIN `burnished-flare-384310`.`seQura_dbt`.`stg_dim_shoppers` s ON o.shopper_id = s.shopper_id\n    LEFT JOIN `burnished-flare-384310`.`seQura_dbt`.`stg_merchants` m ON o.merchant_id = m.merchant_id\n    LEFT JOIN `burnished-flare-384310`.`seQura_dbt`.`stg_product` p ON o.product_id = p.product_id\n    LEFT JOIN `burnished-flare-384310`.`seQura_dbt`.`stg_rel_default_order_type` r ON o.order_id = r.order_id\n    WHERE o.days_unbalanced >= 17  -- Solo consideramos \u00f3rdenes con mora\n),\n\nexpanded_periods AS (\n    -- Generamos una fila para cada `order_id` en funci\u00f3n de sus niveles de mora\n    SELECT \n        order_id,\n        shopper_id,\n        shopper_age,\n        merchant_id,\n        merchant,\n        product,\n        default_type,\n        order_date,\n        month_year_order,\n        current_order_value,\n        total_overdue,\n        days_unbalanced,\n        '17 days' AS delayed_period\n    FROM arrears_data\n    WHERE days_unbalanced >= 17\n\n    UNION ALL\n\n    SELECT \n        order_id,\n        shopper_id,\n        shopper_age,\n        merchant_id,\n        merchant,\n        product,\n        default_type,\n        order_date,\n        month_year_order,\n        current_order_value,\n        total_overdue,\n        days_unbalanced,\n        '30 days' AS delayed_period\n    FROM arrears_data\n    WHERE days_unbalanced >= 30\n\n    UNION ALL\n\n    SELECT \n        order_id,\n        shopper_id,\n        shopper_age,\n        merchant_id,\n        merchant,\n        product,\n        default_type,\n        order_date,\n        month_year_order,\n        current_order_value,\n        total_overdue,\n        days_unbalanced,\n        '60 days' AS delayed_period\n    FROM arrears_data\n    WHERE days_unbalanced >= 60\n\n    UNION ALL\n\n    SELECT \n        order_id,\n        shopper_id,\n        shopper_age,\n        merchant_id,\n        merchant,\n        product,\n        default_type,\n        order_date,\n        month_year_order,\n        current_order_value,\n        total_overdue,\n        days_unbalanced,\n        '90 days' AS delayed_period\n    FROM arrears_data\n    WHERE days_unbalanced >= 90\n)\n\nSELECT \n    order_id,\n    shopper_id,\n    shopper_age,\n    merchant_id,\n    merchant,\n    product,\n    default_type,\n    order_date,\n    month_year_order,\n    current_order_value,\n    total_overdue,\n    days_unbalanced,\n    delayed_period\nFROM expanded_periods\nORDER BY order_id, delayed_period", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`intermediate_loans_mora_analysis`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-11T19:12:00.629386Z", "completed_at": "2024-09-11T19:12:00.638207Z"}, {"name": "execute", "started_at": "2024-09-11T19:12:00.638871Z", "completed_at": "2024-09-11T19:12:04.894810Z"}], "thread_id": "Thread-1", "execution_time": 4.267263889312744, "adapter_response": {"_message": "CREATE TABLE (37.0 rows, 2.4 KiB processed)", "code": "CREATE TABLE", "rows_affected": 37, "bytes_processed": 2473, "bytes_billed": 52428800, "location": "EU", "project_id": "burnished-flare-384310", "job_id": "203515ef-ea25-43f7-9bc8-d46255e8a6cb", "slot_ms": 1373}, "message": "CREATE TABLE (37.0 rows, 2.4 KiB processed)", "failures": null, "unique_id": "model.my_dbt_project.final_loans_mora_analysis", "compiled": true, "compiled_code": "\n\nSELECT \n    shopper_age,\n    month_year_order,\n    product,\n    merchant,\n    default_type,\n    delayed_period\nFROM `burnished-flare-384310`.`seQura_dbt`.`intermediate_loans_mora_analysis`\nORDER BY month_year_order, delayed_period", "relation_name": "`burnished-flare-384310`.`seQura_dbt`.`final_loans_mora_analysis`"}], "elapsed_time": 8.401487827301025, "args": {"log_level": "info", "exclude": [], "select": [], "static_parser": true, "partial_parse": true, "log_path": "/Users/raulvazquez/seQura_test/Part2/my_dbt_project/logs", "source_freshness_run_project_hooks": false, "cache_selected_only": false, "print": true, "profiles_dir": "/Users/raulvazquez/.dbt", "project_dir": "/Users/raulvazquez/seQura_test/Part2/my_dbt_project", "macro_debugging": false, "version_check": true, "log_level_file": "debug", "log_format": "default", "indirect_selection": "eager", "show_resource_report": false, "invocation_command": "dbt run", "use_colors": true, "use_colors_file": true, "empty": false, "printer_width": 80, "quiet": false, "log_format_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "which": "run", "enable_legacy_logger": false, "write_json": true, "favor_state": false, "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "defer": false, "send_anonymous_usage_stats": true, "populate_cache": true, "log_file_max_bytes": 10485760, "partial_parse_file_diff": true, "introspect": true, "require_resource_names_without_spaces": false}}